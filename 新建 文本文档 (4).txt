import os
import datetime
import subprocess

def auto_git_push():
    try:
        # å½“å‰ç›®å½•
        repo_path = os.path.dirname(os.path.abspath(__file__))
        os.chdir(repo_path)

        # è·å–å½“å‰æ—¶é—´ä½œä¸ºæäº¤ä¿¡æ¯
        now = datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        commit_msg = f"Auto update at {now}"

        # Git å‘½ä»¤åˆ—è¡¨
        cmds = [
            ["git", "add", "."],
            ["git", "commit", "-m", commit_msg],
            ["git", "push"]
        ]

        # é¡ºåºæ‰§è¡Œ
        for cmd in cmds:
            result = subprocess.run(cmd, capture_output=True, text=True)
            if result.returncode != 0:
                print(f"âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼š{' '.join(cmd)}")
                print(result.stderr)
                return
            else:
                print(f"âœ… æˆåŠŸæ‰§è¡Œï¼š{' '.join(cmd)}")

        print("ğŸ‰ å·²è‡ªåŠ¨æäº¤å¹¶æ¨é€åˆ° GitHubï¼")

    except Exception as e:
        print("âŒ å‘ç”Ÿå¼‚å¸¸ï¼š", e)

if __name__ == "__main__":
    auto_git_push()
